{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst apiKey = '43905959-78fd6b1a15a9bfecd4ebaa3d3';\nconst BASE_URL = 'https://pixabay.com/api/';\naxios.defaults.baseURL = BASE_URL;\n\nexport const fetchPhotosByQuery = (query = 'dog', page = 1, perPage = 15) => {\n  const searchParams = {\n    key: apiKey,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    page: page,\n    per_page: perPage,\n  };\n\n  return axios(`${BASE_URL}`, {\n    params: searchParams,\n  });\n  // return fetch(`${BASE_URL}?${searchParams}`).then(response => {\n  //   if (!response.ok) {\n  //     throw new Error(\n  //       `Sorry, there are no images matching your search query. Please try again!`\n  //     );\n  //   }\n  //   return response.json();\n  // });\n};\n","'use strict';\n\nexport const createGalleryItemMarkup = images => {\n  return images\n    .map(\n      image =>\n        `\n      <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n          <img\n            class=\"gallery-image\"\n            src=\"${image.webformatURL}\"\n            alt=\"${image.tags}\"\n          />\n          <ul class=\"gallery-card\">\n            <li>\n              <p>likes</p>\n              <p>${image.likes}</p>\n            </li>\n            <li>\n              <p>views</p>\n              <p>${image.views}</p>\n            </li>\n            <li>\n              <p>comments</p>\n              <p>${image.comments}</p>\n            </li>\n            <li>\n              <p>downloads</p>\n              <p>${image.downloads}</p>\n            </li>\n          </ul>\n        </a>\n      </li>`\n    )\n    .join('');\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchPhotosByQuery } from './js/pixabay-api';\nimport { createGalleryItemMarkup } from './js/render-functions';\n\nconst searchForm = document.querySelector('.search-form');\nconst galleryEl = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst btnLoadMoreEl = document.querySelector('.btn-load-more');\n\nlet searchImages = '';\nlet page = 1;\nlet perPage = 15;\nlet totalPages = '';\n\nasync function onBtnSubmit(event) {\n  event.preventDefault();\n  searchImages = event.target.elements.searchImages.value.trim();\n\n  if (searchImages === '') {\n    galleryEl.innerHTML = '';\n    event.target.reset();\n    iziToast.error({\n      message: 'Input field can not be empty',\n      position: 'topRight',\n      timeout: 2000,\n      color: 'red',\n    });\n    return;\n  }\n\n  galleryEl.innerHTML = '';\n  loader.classList.remove('is-hidden');\n\n  try {\n    const response = await fetchPhotosByQuery(searchImages, page, perPage);\n    const imageData = response.data;\n\n    if (imageData.total === 0) {\n      iziToast.error({\n        message: 'Sorry, there are no images for this query',\n        position: 'topRight',\n        timeout: 3000,\n        color: 'red',\n      });\n      event.target.reset();\n      loader.classList.add('is-hidden');\n      btnLoadMoreEl.classList.add('is-hidden');\n      return;\n    }\n    galleryEl.innerHTML = createGalleryItemMarkup(imageData.hits);\n    galleryEl.style.display = 'flex';\n    galleryEl.style.flexWrap = 'wrap';\n    galleryEl.style.gap = '20px 24px';\n    galleryEl.style.justifyContent = 'center';\n\n    totalPages = Math.ceil(imageData.totalHits / perPage);\n    if (totalPages > 1) {\n      btnLoadMoreEl.classList.remove('is-hidden');\n    }\n\n    const galleryLightBox = new SimpleLightbox('.gallery a', {\n      captions: true,\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n    galleryLightBox.refresh();\n  } catch (error) {\n    iziToast.error({\n      message: 'An error occurred while fetching images',\n      position: 'topRight',\n      timeout: 2000,\n      color: 'red',\n    });\n    console.log(error);\n  }\n\n  event.target.reset();\n  loader.classList.add('is-hidden');\n}\n\nconst scrollLoadMore = () => {\n  const galleryItem = document.querySelector('.gallery-item:last-child');\n  const rect = galleryItem.getBoundingClientRect().height;\n  const scrollHight = rect * 2;\n  window.scrollBy({\n    top: scrollHight,\n    left: 0,\n    behavior: 'smooth',\n  });\n};\n\nasync function onBtnLoadMoreClick(event) {\n  try {\n    page += 1;\n    loader.classList.remove('is-hidden');\n\n    const response = await fetchPhotosByQuery(searchImages, page, perPage);\n    const imageData = response.data;\n\n    galleryEl.insertAdjacentHTML(\n      'beforeend',\n      createGalleryItemMarkup(imageData.hits)\n    );\n    loader.classList.add('is-hidden');\n\n    galleryEl.style.display = 'flex';\n    galleryEl.style.flexWrap = 'wrap';\n    galleryEl.style.gap = '20px 24px';\n    galleryEl.style.justifyContent = 'center';\n\n    const galleryLightBox = new SimpleLightbox('.gallery a', {\n      captions: true,\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n    galleryLightBox.refresh();\n\n    scrollLoadMore();\n\n    if (page >= totalPages) {\n      btnLoadMoreEl.classList.add('is-hidden');\n      btnLoadMoreEl.removeEventListener('click', onBtnLoadMoreClick);\n      iziToast.show({\n        message: `'We're sorry, but you've reached the end of search results.'`,\n        position: 'topRight',\n        timeout: 2000,\n        color: 'green',\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      message: 'An error occurred while fetching images',\n      position: 'topRight',\n      timeout: 2000,\n      color: 'red',\n    });\n    console.log(error);\n  }\n}\n\nsearchForm.addEventListener('submit', onBtnSubmit);\nbtnLoadMoreEl.addEventListener('click', onBtnLoadMoreClick);\n"],"names":["apiKey","BASE_URL","axios","fetchPhotosByQuery","query","page","perPage","searchParams","createGalleryItemMarkup","images","image","searchForm","galleryEl","loader","btnLoadMoreEl","searchImages","totalPages","onBtnSubmit","event","iziToast","imageData","SimpleLightbox","error","scrollLoadMore","scrollHight","onBtnLoadMoreClick"],"mappings":"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"}